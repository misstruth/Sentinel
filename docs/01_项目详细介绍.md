# SuperBizAgent 项目详细介绍

## 一、项目概述

**项目名称**: SuperBizAgent
**项目类型**: AI Agent 智能对话系统
**发布版本**: release-2026-01-09
**主要语言**: Go 1.24.0

SuperBizAgent 是一个基于多 Agent 协作机制的企业级 AI 助手系统，集成了最新的大语言模型技术、向量数据库、工具调用等功能，适用于企业级智能运维和业务辅助场景。

---

## 二、技术栈

### 2.1 后端框架

| 技术 | 版本 | 用途 |
|------|------|------|
| Go | 1.24.0 | 主要编程语言 |
| GoFrame | v2.7.1 | Web 框架 |
| GORM | v1.31.0 | ORM 框架 |
| gRPC | v1.73.0 | RPC 通信 |

### 2.2 AI/LLM 相关

| 技术 | 版本 | 用途 |
|------|------|------|
| Cloudwego Eino | v0.6.0 | AI 编排框架（核心） |
| DeepSeek V3 | - | 大语言模型 |
| Doubao Embedding | - | 文本向量化模型 |
| MCP Protocol | v0.42.0 | 模型上下文协议 |

### 2.3 数据存储

| 技术 | 版本 | 用途 |
|------|------|------|
| Milvus | v2.4.2 | 向量数据库 |
| MySQL | - | 关系型数据库 |

### 2.4 前端技术

- HTML/CSS/JavaScript 纯前端实现
- SSE (Server-Sent Events) 流式响应

---

## 三、项目结构

```
SuperBizAgent-release-2026-01-09/
├── main.go                          # 主程序入口
├── go.mod                           # Go 模块定义
├── go.sum                           # Go 依赖锁定
│
├── api/                             # API 定义
│   └── chat/                        # 聊天 API 接口定义
│
├── internal/                        # 核心业务逻辑
│   ├── ai/                          # AI 相关模块
│   │   ├── agent/                   # Agent 实现
│   │   │   ├── chat_pipeline/       # 聊天管道
│   │   │   ├── knowledge_index_pipeline/  # 知识索引管道
│   │   │   └── plan_execute_replan/ # 计划-执行-重规划
│   │   ├── cmd/                     # AI 命令行工具
│   │   └── tools/                   # AI 工具集
│   ├── consts/                      # 常量定义
│   ├── controller/                  # 控制器层
│   └── logic/                       # 业务逻辑层
│
├── utility/                         # 工具函数库
│   ├── client/                      # 客户端工具
│   ├── common/                      # 通用工具
│   ├── log_call_back/               # 日志回调
│   ├── mem/                         # 内存管理
│   └── middleware/                  # 中间件
│
├── manifest/                        # 配置和部署
│   ├── config/                      # 配置文件
│   └── docker/                      # Docker 配置
│
├── docs/                            # 文档目录
├── hack/                            # 脚本和工具
└── SuperBizAgentFrontend/           # 前端项目
```

---

## 四、核心功能模块

### 4.1 聊天管道 (Chat Pipeline)

**位置**: `/internal/ai/agent/chat_pipeline/`

聊天管道是系统的核心模块，负责处理用户对话请求。

| 文件 | 功能 |
|------|------|
| `orchestration.go` | 聊天 Agent 编排，构建完整的对话处理流程 |
| `flow.go` | ReAct Agent 实现，支持工具调用和推理 |
| `model.go` | LLM 模型配置和初始化 |
| `retriever.go` | Milvus 检索器，从向量库检索相关文档 |
| `embedding.go` | 向量嵌入模型配置 |
| `prompt.go` | 系统提示词模板 |
| `types.go` | 数据类型定义 |

### 4.2 知识索引管道 (Knowledge Index Pipeline)

**位置**: `/internal/ai/agent/knowledge_index_pipeline/`

负责文档的加载、分割、向量化和索引存储。

| 文件 | 功能 |
|------|------|
| `orchestration.go` | 知识索引编排 |
| `loader.go` | 文件加载器 |
| `transformer.go` | 文档转换（Markdown 分割） |
| `indexer.go` | Milvus 索引器 |
| `embedding.go` | 嵌入模型配置 |

### 4.3 计划-执行-重规划 (Plan-Execute-Replan)

**位置**: `/internal/ai/agent/plan_execute_replan/`

用于处理复杂任务的规划和执行。

| 文件 | 功能 |
|------|------|
| `plan_execute_replan.go` | 主编排逻辑 |
| `planner.go` | 任务规划器 |
| `executor.go` | 任务执行器 |
| `replan.go` | 重规划器 |

---

## 五、AI 工具集成

**位置**: `/internal/ai/tools/`

| 工具 | 文件 | 功能 |
|------|------|------|
| MySQL CRUD | `mysql_crud.go` | 执行 SQL 查询、插入、更新、删除 |
| Prometheus 告警 | `query_metrics_alerts.go` | 查询 Prometheus 活跃告警 |
| 日志查询 | `query_log.go` | 通过 MCP 协议查询日志 |
| 内部文档 | `query_internal_docs.go` | 查询内部知识库文档 |
| 当前时间 | `get_current_time.go` | 获取系统当前时间 |

---

## 六、API 接口

**位置**: `/internal/controller/chat/`

| 接口 | 文件 | 功能 |
|------|------|------|
| ChatStream | `chat_v1_chat_stream.go` | 流式聊天，SSE 实时返回 |
| Chat | `chat_v1_chat.go` | 普通聊天，一次性返回 |
| AI Ops | `chat_v1_ai_ops.go` | AI 运维操作 |
| FileUpload | `chat_v1_file_upload.go` | 知识库文件上传 |

**服务配置**:
- 端口: 6872
- 路由前缀: `/api`
- 中间件: CORS、响应格式化

---

## 七、核心架构流程

### 7.1 聊天流程

```
用户输入
    ↓
ChatStream/Chat API
    ↓
构建 UserMessage (包含历史记录)
    ↓
BuildChatAgent (编排图)
    ├─ InputToRag: 用户查询转 RAG 输入
    ├─ MilvusRetriever: 从向量库检索相关文档
    ├─ ChatTemplate: 构建提示词模板
    ├─ InputToChat: 用户消息转聊天输入
    └─ ReActAgent: 执行工具调用和推理
    ↓
LLM 推理 (DeepSeek V3)
    ├─ 工具调用 (MySQL、Prometheus、日志等)
    ├─ 工具结果反馈
    └─ 最终回复生成
    ↓
流式/完整返回给客户端
    ↓
保存到内存 (SimpleMemory)
```

### 7.2 知识索引流程

```
文档文件
    ↓
FileLoader: 加载文档
    ↓
MarkdownSplitter: 分割文档
    ↓
Embedding: 向量化
    ↓
MilvusIndexer: 索引存储
```

---

## 八、配置管理

**配置文件位置**: `/manifest/config/config.yaml`

主要配置项：

```yaml
server:
  address: ":8000"
  openapiPath: "/api.json"
  swaggerPath: "/swagger"

logger:
  level: "all"
  stdout: true
```

**模型配置**:
- `ds_think_chat_model`: DeepSeek 思考模型
- `ds_quick_chat_model`: DeepSeek 快速模型
- `doubao_embedding_model`: 阿里百炼嵌入模型

---

## 九、项目特点总结

### 9.1 核心特点

1. **AI 编排框架**: 使用 Cloudwego Eino 进行复杂 AI 流程编排
2. **RAG 系统**: 集成 Milvus 向量数据库实现检索增强生成
3. **工具调用**: 支持多种工具集成 (MySQL、Prometheus、日志等)
4. **流式响应**: 支持 SSE 实时流式返回
5. **多模型支持**: 支持 DeepSeek V3 思考和快速模型
6. **MCP 集成**: 支持 Model Context Protocol 扩展
7. **内存管理**: 维护用户对话历史
8. **模块化设计**: 清晰的分层架构

### 9.2 技术亮点

- 使用 Eino 框架实现复杂的 Agent 编排
- ReAct Agent 模式用于工具调用和推理
- Plan-Execute-Replan 模式用于复杂任务
- 向量数据库用于知识检索
- MCP 协议用于工具扩展

---

## 十、快速启动

### 10.1 后端启动

```bash
# 进入项目目录
cd SuperBizAgent-release-2026-01-09

# 安装依赖
go mod tidy

# 启动服务
go run main.go
```

### 10.2 前端启动

```bash
cd SuperBizAgentFrontend
python3 -m http.server 8080
```

---

**文档版本**: v1.0
**更新日期**: 2026-02-08